(()=>{"use strict";var e;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(e||(e={}));class t{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class n{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function r(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}class s extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new s),this.instance}addProject(n,r,s){const i=new t(Math.random().toString(),n,r,s,e.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(console.log("Move project:",t),n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const i=s.getInstance();class l extends n{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigns",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([r],l.prototype,"dragStartHandler",null);var o=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class a extends n{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(t){const n=t.dataTransfer.getData("text/plain");i.moveProject(n,"active"===this.type?e.Active:e.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),i.addListener((t=>{const n=t.filter((t=>"active"===this.type?t.status===e.Active:t.status===e.Finished));this.assignedProjects=n,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new l(this.element.querySelector("ul").id,e)}}function c(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&+e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&+e.value<=e.max),t}o([r],a.prototype,"dragOverHandler",null),o([r],a.prototype,"dropHandler",null),o([r],a.prototype,"dragLeaveHandler",null);class d extends n{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler.bind(this))}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value,r={value:t,required:!0,minLength:5},s={value:+n,required:!0,min:1,max:5};return c({value:e,required:!0})&&c(r)&&c(s)?[e,t,+n]:void alert("Invalid  input")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;console.log(e,n,r),i.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([r],d.prototype,"submitHandler",null),new d,new a("active"),new a("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50cy50cyIsIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL3ByYWN0aWNlLy4vc3JjL3N0YXRlL3Byb2plY3Qtc3RhdGUudHMiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3ByYWN0aWNlLy4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9hcHAudHMiXSwibmFtZXMiOlsiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJjb25zdHJ1Y3RvciIsImlkIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInBlb3BsZSIsInN0YXR1cyIsIkNvbXBvbmVudCIsInRlbXBsYXRlSWQiLCJob3N0RWxlbWVudElkIiwiaW5zZXJ0QXRTdGFydCIsIm5ld0VsZW1lbnRJZCIsInRoaXMiLCJ0ZW1wbGF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaG9zdEVsZW1lbnQiLCJpbXBvcnRlZEVsZW1lbnQiLCJpbXBvcnROb2RlIiwiY29udGVudCIsImVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImF0dGFjaCIsImluc2VydEF0QmVnaW5uaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiYXV0b2JpbmQiLCJ0YXJnZXQiLCJtZXRob2ROYW1lIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJnZXQiLCJiaW5kIiwiUHJvamVjdFN0YXRlIiwibGlzdGVuZXJzIiwiYWRkTGlzdGVuZXIiLCJsaXN0ZW5lckZuIiwicHVzaCIsInN1cGVyIiwicHJvamVjdHMiLCJpbnN0YW5jZSIsImFkZFByb2plY3QiLCJuZXdQcm9qZWN0IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwiQWN0aXZlIiwidXBkYXRlTGlzdGVuZXJzIiwibW92ZVByb2plY3QiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmluZCIsInByaiIsImNvbnNvbGUiLCJsb2ciLCJzbGljZSIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwiUHJvamVjdEl0ZW0iLCJob3N0SWQiLCJjb25maWd1cmUiLCJyZW5kZXJDb250ZW50IiwiZHJhZ1N0YXJ0SGFuZGxlciIsImV2ZW50IiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImVmZmVjdEFsbG93ZWQiLCJkcmFnRW5kSGFuZGxlciIsIl8iLCJhZGRFdmVudExpc3RlbmVyIiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwicGVyc29ucyIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJ0eXBlcyIsInByZXZlbnREZWZhdWx0IiwiY2xhc3NMaXN0IiwiYWRkIiwiZHJvcEhhbmRsZXIiLCJwcmpJZCIsImdldERhdGEiLCJGaW5pc2hlZCIsImRyYWdMZWF2ZUhhbmRsZXIiLCJyZW1vdmUiLCJyZWxldmFudFByb2plY3RzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByaklJdGVtIiwidmFsaWRhdGUiLCJ2YWxpZGF0YWJsZUlucHV0IiwiaXNWYWxpZCIsInJlcXVpcmVkIiwidHJpbSIsImxlbmd0aCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIm1pbiIsIm1heCIsIlByb2plY3RJbnB1dCIsInRpdGxlSW5wdXRFbGVtZW50IiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJzdWJtaXRIYW5kbGVyIiwiZ2F0aGVyVXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsImRlc2NyaXB0aW9uVmFsaWRhdGFibGUiLCJwZW9wbGVWYWxpZGF0YWJsZSIsImFsZXJ0IiwiY2xlYXJJbnB1dHMiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiXSwibWFwcGluZ3MiOiJtQkFDQSxJQUFZQSxHQUFaLFNBQVlBLEdBQ1IsdUJBQ0EsMkJBRkosQ0FBWUEsTUFBYSxLQUtsQixNQUFNQyxFQUNUQyxZQUNXQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUpBLEtBQUFKLEtBQ0EsS0FBQUMsUUFDQSxLQUFBQyxjQUNBLEtBQUFDLFNBQ0EsS0FBQUMsVUNYQSxNQUFlQyxFQUsxQk4sWUFDSU8sRUFDQUMsRUFDQUMsRUFDQUMsR0FFQUMsS0FBS0MsZ0JBQWtCQyxTQUFTQyxlQUFlUCxHQUMvQ0ksS0FBS0ksWUFBY0YsU0FBU0MsZUFBZU4sR0FFM0MsTUFBTVEsRUFBa0JILFNBQVNJLFdBQzdCTixLQUFLQyxnQkFBZ0JNLFNBQ3JCLEdBR0pQLEtBQUtRLFFBQVVILEVBQWdCSSxrQkFDM0JWLElBQ0FDLEtBQUtRLFFBQVFsQixHQUFLUyxHQUV0QkMsS0FBS1UsT0FBT1osR0FHUlksT0FBT0MsR0FDWFgsS0FBS0ksWUFBWVEsc0JBQXNCRCxFQUFvQixhQUFlLFlBQWFYLEtBQUtRLFVDM0I3RixTQUFTSyxFQUFTQyxFQUFhQyxFQUFvQkMsR0FDdEQsTUFBTUMsRUFBaUJELEVBQVdFLE1BU2xDLE1BUDBDLENBQ3RDQyxjQUFjLEVBQ2RDLE1BRUksT0FEZ0JILEVBQWVJLEtBQUtyQixRQ096QyxNQUFNc0IsVUFUYixvQkFDYyxLQUFBQyxVQUEyQixHQUVyQ0MsWUFBWUMsR0FDUnpCLEtBQUt1QixVQUFVRyxLQUFLRCxLQVN4QixjQUNJ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b3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XG4gICAgQWN0aXZlLFxuICAgIEZpbmlzaGVkXG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyB0aXRsZTogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcbiAgICAgICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxuICAgICAgICBwdWJsaWMgc3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7IH1cbn1cbiIsIi8vIENvbXBvbWVudCBCYXNlIENsYXNzXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcbiAgICB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgaG9zdEVsZW1lbnQ6IFQ7XG4gICAgZWxlbWVudDogVTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICB0ZW1wbGF0ZUlkOiBzdHJpbmcsXG4gICAgICAgIGhvc3RFbGVtZW50SWQ6IHN0cmluZyxcbiAgICAgICAgaW5zZXJ0QXRTdGFydDogYm9vbGVhbixcbiAgICAgICAgbmV3RWxlbWVudElkPzogc3RyaW5nXG4gICAgKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGVtcGxhdGVJZCkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgICAgIHRoaXMuaG9zdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChob3N0RWxlbWVudElkKSEgYXMgVDtcblxuICAgICAgICBjb25zdCBpbXBvcnRlZEVsZW1lbnQgPSBkb2N1bWVudC5pbXBvcnROb2RlKFxuICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCxcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGltcG9ydGVkRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCBhcyBVO1xuICAgICAgICBpZiAobmV3RWxlbWVudElkKVxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxlbWVudElkO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5hdHRhY2goaW5zZXJ0QXRTdGFydCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhdHRhY2goaW5zZXJ0QXRCZWdpbm5pbmc6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoaW5zZXJ0QXRCZWdpbm5pbmcgPyAnYWZ0ZXJiZWdpbicgOiAnYmVmb3JlZW5kJywgdGhpcy5lbGVtZW50KTtcbiAgICAgICAgXG4gICAgfVxuICAgIFxuICAgIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xuICAgIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcbn1cbiIsIi8vIGF1dG9iaW5kIGRlY29yYXRvclxuZXhwb3J0IGZ1bmN0aW9uIGF1dG9iaW5kKHRhcmdldDogYW55LCBtZXRob2ROYW1lOiBzdHJpbmcsIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcikge1xuICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAvL2FkanVzdGVkIG1ldGhvZFxuICAgIGNvbnN0IGFkakRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBib3VuZEZuO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gYWRqRGVzY3JpcHRvcjtcbn1cbiIsImltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XG5cbi8vIFByb2plY3Qgc3RhdGUgbWFuYWdlbWVudFxudHlwZSBMaXN0ZW5lcjxUPiA9IChpdGVtczogVFtdKSA9PiB2b2lkO1xuXG5jbGFzcyBTdGF0ZSA8VD57XG4gICAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdO1xuXG4gICAgYWRkTGlzdGVuZXIobGlzdGVuZXJGbjogTGlzdGVuZXI8VD4pIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lckZuKTtcbiAgICB9XG59XG5cbi8vIFByb2plY3Qgc3RhdGUgbWFuYWdlbWVudFxuZXhwb3J0IGNsYXNzIFByb2plY3RTdGF0ZSBleHRlbmRzIFN0YXRlPFByb2plY3Q+IHtcbiAgICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xuXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0SW5zdGFuY2UgKCkge1xuICAgICAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RhdGUoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gICAgfVxuXG4gICAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBwZW9wbGU6IG51bWJlcikge1xuICAgICAgICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QoXG4gICAgICAgICAgICBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgcGVvcGxlLFxuICAgICAgICAgICAgUHJvamVjdFN0YXR1cy5BY3RpdmUpO1xuICAgICAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XG4gICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgbW92ZVByb2plY3QocHJvamVjdElkOiBzdHJpbmcsIG5ld1N0YXR1czogUHJvamVjdFN0YXR1cykge1xuICAgICAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKHByaiA9PiBwcmouaWQgPT09IHByb2plY3RJZCk7XG4gICAgICAgIGlmIChwcm9qZWN0ICYmIHByb2plY3Quc3RhdHVzIT09bmV3U3RhdHVzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTW92ZSBwcm9qZWN0OicsIG5ld1N0YXR1cylcbiAgICAgICAgICAgIHByb2plY3Quc3RhdHVzID0gbmV3U3RhdHVzO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xuICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyRm4gb2YgdGhpcy5saXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpO1xuIiwiaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCdcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XG4vL2ltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vYmFzZS1jb21wb25lbnRzJztcbmltcG9ydCBDb21wb25lbnQgZnJvbSBcIi4vYmFzZS1jb21wb25lbnRzXCI7XG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gJy4uL2RlY29yYXRvcnMvYXV0b2JpbmQnO1xuXG4vLyBQcm9qZWN0SXRlbSBDbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+XG4gICAgaW1wbGVtZW50cyBEcmFnZ2FibGUge1xuICAgIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcblxuICAgIGdldCBwZXJzb25zKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9qZWN0LnBlb3BsZSA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuICcxIHBlcnNvbic7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gYCR7dGhpcy5wcm9qZWN0LnBlb3BsZX0gcGVyc29uc2A7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xuICAgICAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKTtcbiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDtcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgICB9XG5cbiAgICBAYXV0b2JpbmRcbiAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcbiAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKCd0ZXh0L3BsYWluJywgdGhpcy5wcm9qZWN0LmlkKTtcbiAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gJ21vdmUnO1xuICAgIH1cblxuICAgIGRyYWdFbmRIYW5kbGVyKF86IERyYWdFdmVudCkge1xuICAgICAgICBjb25zb2xlLmxvZygnRHJhZ0VuZCcpO1xuICAgIH1cblxuICAgIGNvbmZpZ3VyZSgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kSGFuZGxlcik7XG5cbiAgICB9XG5cbiAgICByZW5kZXJDb250ZW50KCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29ucyArICcgYXNzaWducyc7XG4gICAgICAgICAgICA7XG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdwJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LmRlc2NyaXB0aW9uO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IERyYWdUYXJnZXQgfSBmcm9tICcuLi9tb2RlbHMvZHJhZy1kcm9wJ1xuaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0Jztcbi8vaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudHMnO1xuaW1wb3J0IENvbXBvbmVudCBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudHNcIjtcbmltcG9ydCB7IGF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlJztcbmltcG9ydCB7IFByb2plY3RJdGVtIH0gZnJvbSAnLi9wcm9qZWN0LWl0ZW0nO1xuXG4vLyBQcm9qZWN0TGlzdCBDbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD5cbiAgICBpbXBsZW1lbnRzIERyYWdUYXJnZXR7XG4gICAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJyB8ICdmaW5pc2hlZCcpIHtcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtbGlzdCcsICdhcHAnLCBmYWxzZSwgYCR7dHlwZX0tcHJvamVjdHNgKTtcbiAgICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gW107XG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XG4gICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xuICAgIH1cblxuICAgIEBhdXRvYmluZFxuICAgIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XG4gICAgICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYXV0b2JpbmRcbiAgICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XG4gICAgICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChcbiAgICAgICAgICAgIHByaklkLFxuICAgICAgICAgICAgdGhpcy50eXBlID09PSAnYWN0aXZlJyA/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZFxuICAgICAgICApO1xuICAgIH1cblxuICAgIEBhdXRvYmluZFxuICAgIGRyYWdMZWF2ZUhhbmRsZXIoXzogRHJhZ0V2ZW50KSB7XG4gICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpITtcbiAgICAgICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpOyBcbiAgICB9XG4gICAgXG4gICAgY29uZmlndXJlKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVySGFuZGxlcik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xuICAgICAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlbGV2YW50UHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIocHJqID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50eXBlID09PSAnYWN0aXZlJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BY3RpdmVcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IHJlbGV2YW50UHJvamVjdHM7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJlbmRlckNvbnRlbnQoKSB7XG4gICAgICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGA7XG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCA9IGxpc3RJZDtcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy50eXBlLnRvVXBwZXJDYXNlKCkgKyAnIFBST0pFQ1RTJztcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xuICAgICAgICBjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcbiAgICAgICAgbGlzdEVsLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBmb3IgKGNvbnN0IHByaklJdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xuICAgICAgICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCwgcHJqSUl0ZW0pO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiLy8gVmFsaWRhdGlvblxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0YWJsZSB7XG4gICAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcbiAgICByZXF1aXJlZD86IGJvb2xlYW47XG4gICAgbWluTGVuZ3RoPzogbnVtYmVyO1xuICAgIG1heExlbmd0aD86IG51bWJlcjtcbiAgICBtaW4/OiBudW1iZXI7XG4gICAgbWF4PzogbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUodmFsaWRhdGFibGVJbnB1dDogVmFsaWRhdGFibGUpIHtcbiAgICBsZXQgaXNWYWxpZCA9IHRydWU7XG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQucmVxdWlyZWQpIHtcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggIT09IDA7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSdzdHJpbmcnKSB7XG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoID49IHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0nc3RyaW5nJykge1xuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmICt2YWxpZGF0YWJsZUlucHV0LnZhbHVlID49IHZhbGlkYXRhYmxlSW5wdXQubWluO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5tYXggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgK3ZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPD0gdmFsaWRhdGFibGVJbnB1dC5tYXg7XG4gICAgfVxuICAgIHJldHVybiBpc1ZhbGlkO1xufVxuIiwiLy9pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudHNcIjtcbmltcG9ydCBDb21wb25lbnQgZnJvbSBcIi4vYmFzZS1jb21wb25lbnRzXCI7XG4vL2ltcG9ydCB7IFZhbGlkYXRhYmxlLCB2YWxpZGF0ZSB9IGZyb20gXCIuLi91dGlsL3ZhbGlkYXRpb25cIjtcbmltcG9ydCAqIGFzIFZhbGlkYXRpb24gZnJvbSBcIi4uL3V0aWwvdmFsaWRhdGlvblwiO1xuLy9pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XG5pbXBvcnQgeyBhdXRvYmluZCBhcyBBdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xuXG4vL1Byb2plY3RJbnB1dCBDbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PntcbiAgICB0aXRsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgICBkZXNjcmlwdGlvbklucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKTtcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkZXNjcmlwdGlvbicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwZW9wbGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIH1cblxuICAgIGNvbmZpZ3VyZSgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0SGFuZGxlci5iaW5kKHRoaXMpKVxuICAgIH1cbiAgICBcbiAgICByZW5kZXJDb250ZW50KCkgeyB9XG5cbiAgICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB1bmRlZmluZWQge1xuICAgICAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgICAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgICAgICBjb25zdCBlbnRlcmVkUGVvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0aXRsZVZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuICAgICAgICAgICAgdmFsdWU6IGVudGVyZWRUaXRsZSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb25WYWxpZGF0YWJsZTogVmFsaWRhdGlvbi5WYWxpZGF0YWJsZSA9IHtcbiAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkRGVzY3JpcHRpb24sXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIG1pbkxlbmd0aDogNVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHBlb3BsZVZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuICAgICAgICAgICAgdmFsdWU6ICtlbnRlcmVkUGVvcGxlLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICBtaW46IDEsXG4gICAgICAgICAgICBtYXg6IDVcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoIVZhbGlkYXRpb24udmFsaWRhdGUodGl0bGVWYWxpZGF0YWJsZSkgfHxcbiAgICAgICAgICAgICFWYWxpZGF0aW9uLnZhbGlkYXRlKGRlc2NyaXB0aW9uVmFsaWRhdGFibGUpIHx8XG4gICAgICAgICAgICAhVmFsaWRhdGlvbi52YWxpZGF0ZShwZW9wbGVWYWxpZGF0YWJsZSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBhbGVydCgnSW52YWxpZCAgaW5wdXQnKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtlbnRlcmVkVGl0bGUsIGVudGVyZWREZXNjcmlwdGlvbiwgK2VudGVyZWRQZW9wbGVdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZT0nJztcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZT0nJztcbiAgICAgICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWU9Jyc7XG4gICAgfVxuXG4gICAgLy9jaGFuZ2UgdHNjb25maWcuanNvbjogc2V0IGV4cGVyaW1lbnRhbERlY29yYXRvcnM6IHRydWUgKHJ1biB0c2MgLXcpXG4gICAgQEF1dG9iaW5kXG4gICAgcHJpdmF0ZSBzdWJtaXRIYW5kbGVyKGV2ZW50OiBFdmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh1c2VySW5wdXQpKSB7XG4gICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGVdID0gdXNlcklucHV0O1xuICAgICAgICAgICAgY29uc29sZS5sb2codGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGUpO1xuICAgICAgICAgICAgcHJvamVjdFN0YXRlLmFkZFByb2plY3QodGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGUpO1xuICAgICAgICAgICAgdGhpcy5jbGVhcklucHV0cygpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0JztcbmltcG9ydCB7IFByb2plY3RJbnB1dCB9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWlucHV0JztcblxuY29uc3QgcHJqSW5wdXQgPSBuZXcgUHJvamVjdElucHV0KCk7XG5jb25zdCBhY3RpdmVQcmpMaXN0ID0gbmV3IFByb2plY3RMaXN0KCdhY3RpdmUnKTtcbmNvbnN0IGZpbmlzaGVkUHJqTGlzdCA9IG5ldyBQcm9qZWN0TGlzdCgnZmluaXNoZWQnKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=